{"version":3,"sources":["webparts/webSites/components/WebSites.tsx"],"names":[],"mappings":"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","file":"webparts/webSites/components/WebSites.js","sourcesContent":["import * as React from 'react';\r\nimport styles from './WebSites.module.scss';\r\nimport { IWebSitesProps } from './IWebSitesProps';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport * as pnp from 'sp-pnp-js';\r\nimport * as moment from 'moment';\r\nrequire('./websites.css');\r\nrequire('./sharepoint.css');\r\nlet colorArr = [\"#0000FF\", \"#0000FF\", \"#D2691E\", \"#FF0000\", \"#2E8B57\", \"#FFD700\", \"#20B2AA\", \"#696969\", \"#663399\", \"#9400D3\", \"#FFA500\", \"#228B22\", \"#663399\", \"#8A2BE2\", \"#B22222\", \"#FF8C00\"];\r\nlet color: string = \"\";\r\nlet i: number = 0;\r\nlet _websArr = [];\r\nexport default class WebSites extends React.Component<IWebSitesProps, any> {\r\n    constructor(props: IWebSitesProps) {\r\n        super(props);\r\n        this.state = {\r\n            webs: []\r\n        };\r\n    }\r\n    private getColor(): string {\r\n        i = Math.floor((Math.random() * colorArr.length - 1) + 1);\r\n        color = colorArr[i];\r\n        return color;\r\n    }\r\n    // Load Item Attachments\r\n    private _loadWebSites() {\r\n        //let\r\n        let _currentUser = this.props.pageContext.user.loginName;\r\n        this.addSubSite(this.props.pageContext.web.absoluteUrl);\r\n    }\r\n    // \r\n    public componentDidMount() {\r\n        this._loadWebSites();\r\n    }\r\n\r\n    // Render WebSites\r\n    public render() {\r\n\r\n        return (\r\n            <div className=\"wrapper\">\r\n                {this.state.webs.length != 0 ? <p style={{ margintop: 0, marginBottom: 10 }} className=\"ms-font-xxl\">{this.props.title}</p> : ''}\r\n\r\n                <div className=\"sites-area\">\r\n                    {this.state.webs.map((_web: any, ix: number) => {\r\n                        return (\r\n                            <div className=\"ContainerCard social-buttons-in social-buttons-in\">\r\n                                <div><a href={_web.ServerRelativeUrl}>\r\n                                    <div style={{ backgroundColor: 'rgba(192, 192, 192, 0.13)' }} aria-labelledby=\"cardNoActivitiesDesc\" className=\"ContainerCard-header\" data-focusable-context=\"ActivityCards\" data-is-focusable=\"true\" data-nested-context=\"Card\" role=\"gridcell\">\r\n                                        <div title={_web.ServerRelativeUrl}><div className=\"ContainerCard-headerBackground\" style={{ backgroundColor: this.getColor() }}>\r\n                                        </div>\r\n                                            <div className=\"ContainerCard-acronym\" role=\"presentation\" aria-hidden=\"true\" style={{ backgroundColor: color }}>{_web.Title.substring(0, 1)}</div>\r\n                                            <div className=\"ContainerCard-title\" aria-label=\"Site\">{_web.Title}</div>\r\n                                            <div className=\"ContainerCard-subTitle\">Last change on: {moment(_web.LastItemModifiedDate).format(\"DD MMMM YYYY\")}</div>\r\n                                    </div></div></a>\r\n                                        <div className=\"ContainerCard-socialButtons\">\r\n                                        <div className=\"ContainerCard-buttons-float\">\r\n                                            <div aria-label=\"\" className=\"ContainerCard-socialButton\" data-focusable-context=\"Card\" ><i role=\"presentation\" title=\"\" className=\"mdl2-Icon ms-Icon--Globe\"></i>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                <div>\r\n                                <div className=\"ContainerCard-socialButtons-overflow\"><i className=\"mdl2-Icon mdl2-Icon--more\"></i></div>\r\n                                </div>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Add SubSites recursive\r\n    private addSubSite(_webUrl: any) {\r\n        let _iconUrl = '';\r\n        let baseUrl = window.location.protocol + \"//\" + window.location.host;\r\n        let _subWeb = new pnp.Web(_webUrl);\r\n        _subWeb.getSubwebsFilteredForCurrentUser().filter(\"WebTemplate ne 'APP'\").get()\r\n            .then(_webs => {\r\n                _webs.map((_web_: any, j: number) => {\r\n                    _websArr.push(_web_);\r\n                    console.log(baseUrl + \"-\" + _web_.ServerRelativeUrl);\r\n                    this.addSubSite(`${baseUrl}${_web_.ServerRelativeUrl}`);\r\n                    this.setState({\r\n                        webs: _websArr\r\n                    });\r\n                });\r\n            })\r\n            .catch((reason: any) => {\r\n                alert(\"Error on read subsites. Error: \\n\" + reason);\r\n            });\r\n    }\r\n}\r\n\r\n\r\n"],"sourceRoot":"../../../../src"}