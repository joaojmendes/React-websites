{"version":3,"sources":["webparts/webSites/components/WebSites_jm.tsx"],"names":[],"mappings":"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","file":"webparts/webSites/components/WebSites_jm.js","sourcesContent":["import * as React from 'react';\r\nimport styles from './WebSites.module.scss';\r\nimport { IWebSitesProps } from './IWebSitesProps';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport * as pnp from 'sp-pnp-js';\r\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { PrimaryButton, } from 'office-ui-fabric-react/lib/Button';\r\nimport { withStyles } from 'material-ui/styles';\r\nimport Card, { CardActions, CardContent } from 'material-ui/Card';\r\nimport Button from 'material-ui/Button';\r\nimport Typography from 'material-ui/Typography';\r\nrequire('./websites.css');\r\nimport {\r\n    DocumentCard,\r\n    // DocumentCardActivity,\r\n    DocumentCardActions,\r\n    DocumentCardPreview,\r\n    DocumentCardTitle,\r\n    DocumentCardType,\r\n    IDocumentCardPreviewProps\r\n} from 'office-ui-fabric-react/lib/DocumentCard';\r\nimport { ImageFit } from 'office-ui-fabric-react/lib/Image';\r\nimport { PermissionKind } from 'sp-pnp-js';\r\nlet previewImages = new Array<any>();\r\nlet previewPropsUsingIcon: IDocumentCardPreviewProps;\r\nexport default class WebSites extends React.Component<IWebSitesProps, any> {\r\n    constructor(props: IWebSitesProps) {\r\n        super(props);\r\n        this.state = {\r\n            showDialog: false,\r\n            dialogMessage: '',\r\n            webs: []\r\n        };\r\n    }\r\n\r\n    // Load Item Attachments\r\n    private _loadWebSites() {\r\n        previewImages = [];\r\n        //  let _webs = pnp.sp.web.webs.get();\r\n        // let item = pnp.sp.web.lists.getById(this.props.ListGuid)\r\n        //     .items.getById(this.props.RaidId);\r\n        let webSite = new pnp.Web(this.props.pageContext.web.absoluteUrl);\r\n        let _currentUser = this.props.pageContext.user.loginName;\r\n        let _websArr = [];\r\n        webSite.webs.filter(\"WebTemplate ne 'APP'\").get().then(_webs => {\r\n\r\n            _webs.map((_web: any, i: number) => {\r\n                let _iconUrl = '';\r\n                let _subWeb = new pnp.Web(_web.Url);\r\n                let _userHasPermission: boolean = false;\r\n                _subWeb.currentUserHasPermissions(PermissionKind.ViewPages).then(_result => {\r\n                    if (_result == true) {\r\n                        _websArr.push(_web);\r\n                        previewImages.push({\r\n                            name: _web.Title,\r\n                            url: _web.Url,\r\n                            previewImageSrc: _web.SiteLogoUrl,\r\n                            previewIconProps: { iconName: 'Globe', styles: { root: { fontSize: 48, color: '#333333' } } },\r\n                            iconSrc: '',\r\n                            imageFit: ImageFit.cover,\r\n                            width: 120,\r\n                            height: 120,\r\n                            accentColor: '#0078d7'\r\n                        });\r\n                        this.setState({\r\n                            webs: _websArr\r\n                        });\r\n                    }\r\n                });\r\n                /*   previewImages.push({\r\n                     previewIconProps: { iconName: 'Globe', styles: { root: { fontSize: 42, color: '#0080ff' } } },\r\n                     width: 120,\r\n                     height: 120\r\n                   });\r\n                    previewPropsUsingIcon = {\r\n                     previewImages: previewImages\r\n                   }; */\r\n\r\n            });\r\n        })\r\n            .catch((reason: any) => {\r\n                /*  this.setState({\r\n                    showDialog: true,\r\n                    // tslint:disable-next-line:max-line-length\r\n                    dialogMessage: 'Error on read subsites. Error: ' + reason\r\n                  });*/\r\n                alert(\"Error on read subsites. Error: \" + reason);\r\n            });\r\n    }\r\n\r\n    // Run befor render component\r\n    public componentDidMount() {\r\n        this._loadWebSites();\r\n    }\r\n\r\n    // Render Attachments\r\n    public render() {\r\n\r\n        return (\r\n            <div>\r\n\r\n\r\n                <p style={{ margintop: 0 }} className=\"ms-font-xxl\">{this.props.title}</p>\r\n                {this.state.webs.map((_web: any, i: number) => {\r\n                    return (\r\n                        <div>\r\n                            <a href={_web.Url} className=\"link\">\r\n                                <Card className=\".card\">\r\n                                    <div style={{ height: 35, backgroundColor: '#ff3333' }}>\r\n\r\n                                    </div>\r\n                                    <div className=\"ContainerCard-bannerImage\"></div>\r\n                                    <CardContent>\r\n                                        <Typography className=\"title\">{_web.Title}</Typography>\r\n                                        <div className=\"divider\"></div>\r\n                                    </CardContent>\r\n\r\n                                </Card>\r\n                            </a>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // close dialog\r\n    private _closeDialog(e: any) {\r\n        //  \r\n        e.preventDefault();\r\n        this.setState({\r\n            showDialog: false,\r\n            dialogMessage: '',\r\n        });\r\n    }\r\n}\r\n\r\n\r\n"],"sourceRoot":"../../../../src"}